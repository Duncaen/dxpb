<class
	name = "pkggraph_msg"
	signature = "3"
	title = "Package Graph Potocol"
	script = "../exec/zproto_codec_c"
	package_dir = "../include"
	source_dir = "."
	>

	<header>
		<field name = "proto_version" type = "string" value = "GRPH00">
			Package Graph Protocol Version 00
		</field>
	</header>

	<message name = "HELLO"    id = "1" />
	<message name = "ROGER"    id = "2" />
	<message name = "IFORGOTU" id = "3" />
	<message name = "INVALID"  id = "4" />
	<message name = "PING"     id = "5" />
	<message name = "STOP"     id = "6" />
	<message name = "PKGDEL"   id = "7" >
		<field name = "pkgname" type = "string" />
	</message>

	<message name = "ICANHELP" id = "9">
		<field name = "hostarch" type = "string" />
		<field name = "targetarch" type = "string" />
		<field name = "iscross" type = "number" size = "1">
			Strict servers might double check this.
		</field>
		<field name = "cost" type = "number" size = "2">
			This should be 100 unless the builder is expensive or slow enough to warrant a lower priority when handing out work. If it's just really fast, then more builders are the answer, not a negative cost.
		</field>
		<field name = "addr" type = "number" size = "2" />
		<field name = "check" type = "number" size = "4" />
	</message>

	<message name = "WORKERCANHELP" id = "10">
		<field name = "addr" type = "number" size = "2" />
		<field name = "check" type = "number" size = "4" />
		<field name = "pkgname" type = "string" />
		<field name = "version" type = "string" />
		<field name = "arch" type = "string" />
	</message>

	<!--- Don't don't don't don't you --->
	<message name = "FORGET ABOUT ME" id = "11">
		<!--- I'll be alone. Dancing, you know it baby --->
		<field name = "addr" type = "number" size = "2" />
		<field name = "check" type = "number" size = "4" />
	</message>

	<message name = "RESETLOG" id = "12">
		<field name = "pkgname" type = "string" />
		<field name = "version" type = "string" />
		<field name = "arch" type = "string" />
	</message>

	<message name = "LOGHERE" id = "13">
		<field name = "pkgname" type = "string" />
		<field name = "version" type = "string" />
		<field name = "arch" type = "string" />
		<field name = "logs" type = "chunk">
			Arbitrary text field to append to appropiate log file.
		</field>
	</message>

	<message name = "UPDATE BOOTSTRAP" id = "14">
		Useful for when a bootstrap package has been upgraded.
	</message>

	<message name = "JOB ENDED" id = "15">
		For any reason.
		<field name = "addr" type = "number" size = "2" />
		<field name = "check" type = "number" size = "4" />
		<field name = "cause" type = "number" size = "1">
			These are enumerated in bworker_end_status.h
		</field>
		<field name = "pkgname" type = "string" />
		<field name = "version" type = "string" />
		<field name = "arch" type = "string" />
	</message>

	<message name = "IMTHEGRAPHER" id = "16"/ >
	<message name = "IAMSTORAGE" id = "17"/ >
	<message name = "IMAWORKER" id = "18"/ >
	<message name = "GRAPHREADY" id = "19"/ >
	<message name = "GRAPHNOTREADY" id = "20" />
</class>
